<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Chart from CSV</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> 
</head>
<body>

<input type="file" id="csvInput" accept=".csv" />

<div id="scatter-plot" style="width: 600px; height: 400px;"></div>

<script>
function loadCSV(file){
  Papa.parse(file, {
    complete: function(result) {
      console.log(result.data);
      createBubbleChart(result.data);  
    },
    header: true
  })
}

document.getElementById('csvInput').addEventListener('change', function(e){
  const file = e.target.files[0];
  if (!file) {
    alert("No file chosen!");  
  } else {
    console.log(file);  // Log the file object to check if it's correctly selected
    loadCSV(file);  // If a file is selected, parse and load it
  }
});

function createBubbleChart(data){
  // Prepare data for Plotly (scatter chart)
  var trace1 = {
    x: data.map(row => parseFloat(row.elevation)),  
    y: data.map(row => parseFloat(row.distance)),  
    mode: 'markers',  
    type: 'scatter',
    text: data.map(row => row.trail_name), 
    hoverinfo: 'text',  
    marker: {
      color: data.map(row => parseFloat(row.elevation)),  
      colorscale: 'Viridis',  
      size: 6,  
      colorbar: {  
        title: 'Elevation',
        
      },
      cmin: 10,  
      cmax: 2000   
    }
  };

  var layout = {
    title: 'Hikes Elevations vs Distance',
    xaxis: {
      title: "Elevation(feet)",
      range: [0,2000]  
    },
    yaxis: {
      title: 'Distance(miles)',
      range: [0, 17]  
    }
  };

  // Use Plotly to create the chart inside the div with id "scatter-plot"
  Plotly.newPlot('scatter-plot', [trace1], layout);
}
</script>

</body>
</html>
